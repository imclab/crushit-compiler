define(["../libs/md5","./console"],function(e,t){var n=Backbone.View.extend({el:$("#left-panel"),active:!1,cache:{},events:{"submit #crushit":"crushIt","focus #url":"resetCrushIt"},initialize:function(){this.console=new t,this.listenTo(this,"loading",this.loading),this.listenTo(this,"loaded",this.loaded)},resetCrushIt:function(){this.$("#url").val(""),this.console.update("")},crushIt:function(){if(this.active)return;var e=this.$("#url").val();return this.trigger("loading"),this.sendRequest("/crush",this.$("#crushit").serialize(),"text",e),!1},sendRequest:function(t,n,r,i){var s="ct"+e(i),o=this;if(o.cache.hasOwnProperty(s)&&_.isEqual(n,o.cache[s].request))return o.trigger("loaded"),o.console.update(o.cache[s].code),!1;$.post(t,n,function(e){o.trigger("loaded"),o.console.update(e),o.cache[s]={url:i,request:n,code:e}},r)},loading:function(){this.console.update("Crushing scripts...."),this.$("#submit").addClass("disabled").attr("disabled","disabled"),$("#loading").removeClass("loading-inactive").addClass("loading-active"),this.active=!0},loaded:function(){this.$("#submit").removeClass("disabled").attr("disabled",!1),$("#loading").removeClass("loading-active").addClass("loading-inactive"),this.active=!1}});return n});